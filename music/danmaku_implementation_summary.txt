弹幕功能实现总结

实现内容：
1. 全局弹幕存储系统
   - 使用 localStorage 存储弹幕记录
   - 最大存储100条记录
   - 12小时过期时间（到期自动清理）

2. 弹幕数据管理
   - DanmakuManager 对象负责所有弹幕数据操作
   - 自动清理过期记录
   - 限制最大记录数量为100条
   - 周期性刷新机制（每10分钟更新一次）

3. 弹幕显示机制
   - 与音乐播放解绑，独立运行
   - 每4秒显示一条随机弹幕
   - 从全局存储中随机获取弹幕内容

4. API容错处理
   - 当API调用失败时，使用默认弹幕内容
   - 随机生成用户头像和名称

5. 系统优化
   - 避免频繁的API调用，提升性能
   - 弹幕内容持久化存储，跨会话可用
   - 独立的刷新机制保持内容新鲜

技术细节：
- 本地存储键名：'danmaku_records'
- 最大记录数：100条
- 过期时间：12小时（43,200,000毫秒）
- 刷新间隔：10分钟
- 显示间隔：4秒

该实现满足了所有要求，弹幕功能现在具有全局存储、到期更新、随机刷新等特性，且独立于具体播放的歌曲。