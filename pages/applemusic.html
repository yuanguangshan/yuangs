<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>æå®¢éŸ³ä¹æ’­æ”¾å™¨ (éšæœºæ¢ç´¢ç‰ˆ)</title>
    <style>
        :root {
            --primary: #1db954;
            --accent: #ff5722; /* éšæœºæŒ‰é’®çš„é¢œè‰² */
            --dark: #121212;
            --gray: #181818;
            --light: #b3b3b3;
            --white: #ffffff;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; }
        
        body {
            background-color: var(--dark);
            color: var(--white);
            height: 100vh;
            width: 100vw;
            overflow: hidden;
            position: relative;
        }

        /* 1. é¡¶éƒ¨æœç´¢æ  */
        .search-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 70px;
            background: rgba(18, 18, 18, 0.95);
            backdrop-filter: blur(10px);
            z-index: 50;
            display: flex;
            align-items: center;
            padding: 0 15px;
            gap: 8px; /* æŒ‰é’®ä¹‹é—´çš„é—´è· */
            border-bottom: 1px solid #333;
        }

        input {
            flex: 1;
            padding: 10px 15px;
            border-radius: 20px;
            border: 1px solid #333;
            background: #2a2a2a;
            color: white;
            font-size: 14px;
            outline: none;
            min-width: 0; /* é˜²æ­¢flexæº¢å‡º */
        }

        /* é€šç”¨æŒ‰é’®æ ·å¼ */
        .btn {
            padding: 8px 16px;
            border-radius: 20px;
            border: none;
            color: white;
            font-weight: bold;
            cursor: pointer;
            white-space: nowrap;
            font-size: 13px;
            transition: transform 0.1s;
        }
        .btn:active { transform: scale(0.95); }

        .search-btn { background: var(--primary); }
        
        /* éšæœºæŒ‰é’®æ ·å¼ */
        .random-btn { 
            background: var(--accent); 
            display: flex;
            align-items: center;
            gap: 4px;
        }
        /* å¤©æ°”æŒ‰é’®æ ·å¼ */
        .weather-btn {
            background: #2196F3;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        /* å¼¹å¹•æ¡æ ·å¼ */
        .comment-bar {
            position: fixed;
            bottom: 120px; /* å†æ¬¡æŠ¬é«˜ï¼Œé¿å¼€æ’­æ”¾å™¨ */
            left: 0;
            width: 100%;
            height: 200px; /* å¢åŠ é«˜åº¦ï¼Œå®¹çº³æ›´å¤šè½¨é“ */
            z-index: 90;
            pointer-events: none;
            overflow: hidden;
            display: none; 
        }
        .comment-bar.show { display: block; }
        
        .comment-item {
            position: absolute;
            left: 100%; /* èµ·å§‹ä½ç½®ï¼šå±å¹•å³ä¾§å¤– */
            display: flex;
            align-items: center;
            gap: 10px;
            color: white;
            font-size: 14px;
            white-space: nowrap;
            background: rgba(0,0,0,0.5); /* åŠ æ·±èƒŒæ™¯è‰²ï¼Œæé«˜å¯è¯»æ€§ */
            padding: 6px 16px;
            border-radius: 20px;
            will-change: left;
            animation: slideLeft linear forwards; /* æ—¶é•¿åœ¨ JS ä¸­åŠ¨æ€è®¾ç½® */
            text-shadow: 1px 1px 2px black;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }
        .comment-avatar {
            width: 28px; height: 28px; border-radius: 50%; border: 1px solid white;
        }
        @keyframes slideLeft {
            from { left: 100%; transform: translateX(0); }
            to { left: -20%; transform: translateX(-100%); } /* è·‘åˆ°å±å¹•å·¦ä¾§å¤– */
        }

        /* ... (ä¸­é—´ä»£ç çœç•¥) ... */

        // --- åˆ›æ„4: ä¼ªÂ·å¼¹å¹•è¯„è®ºåŒº (é«˜å¹¶å‘ç‰ˆ) ---
        let commentTimer = null;
        const commentHistory = []; 
        
        function startFakeComments() {
            const bar = document.getElementById('comment-bar');
            bar.classList.add('show');
            
            if(commentTimer) clearTimeout(commentTimer);
            
            // åˆå§‹çˆ†å‘ï¼šå…ˆæ¥ 3 æ¡
            for(let i=0; i<3; i++) {
                setTimeout(processComment, i * 500);
            }
            
            // å¯åŠ¨å¾ªç¯ç”Ÿæˆ
            loopComments();
        }

        function loopComments() {
            processComment();
            // éšæœºé—´éš” 2000ms - 10000ms ç”Ÿæˆä¸€æ¡ï¼Œé™ä½å¯†åº¦
            const nextTime = 2000 + Math.random() * 8000;
            commentTimer = setTimeout(loopComments, nextTime);
        }

        async function processComment() {
            const useCache = commentHistory.length > 0 && Math.random() < 0.4; // æé«˜ä¸€ç‚¹ç¼“å­˜å¤ç”¨ç‡
            
            if (useCache) {
                const randomItem = commentHistory[Math.floor(Math.random() * commentHistory.length)];
                renderComment(randomItem);
            } else {
                await fetchNewComment();
            }
        }

        // ... fetchNewComment ä¿æŒä¸å˜ ...

        function renderComment(data) {
            const bar = document.getElementById('comment-bar');
            const item = document.createElement('div');
            item.className = 'comment-item';
            item.innerHTML = `
                <img src="${data.avatar}" class="comment-avatar">
                <span style="color:#ffeb3b; font-weight:bold;">${data.name}:</span>
                <span>${data.text}</span>
            `;
            
            // è½¨é“é€»è¾‘ï¼šå°†é«˜åº¦åˆ†ä¸º 5 ä¸ªè½¨é“ï¼Œé˜²æ­¢é‡å 
            // è½¨é“é«˜åº¦çº¦ 35px
            const trackIndex = Math.floor(Math.random() * 5); 
            const topPos = trackIndex * 40; // æ¯æ¡è½¨é“é—´éš” 40px
            
            item.style.top = topPos + 'px';
            
            // éšæœºé€Ÿåº¦ (15s - 25s)ï¼Œæ…¢ä¸€ç‚¹æ›´æœ‰æ°›å›´
            const randomDuration = 15 + Math.random() * 10;
            item.style.animationDuration = randomDuration + 's';

            item.onanimationend = () => {
                item.remove();
            };
            
            bar.appendChild(item);
        }

        /* æ­Œæ‰‹ç™¾ç§‘æ ·å¼ */
        .artist-wiki {
            width: 100%;
            max-width: 600px;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 20px;
            font-size: 13px;
            color: #ccc;
            line-height: 1.6;
            text-align: left;
            display: none;
        }
        .artist-wiki.show { display: block; }

        /* ... (ä¸­é—´ä»£ç çœç•¥) ... */

        // --- åˆ›æ„4: ä¼ªÂ·å¼¹å¹•è¯„è®ºåŒº (å‡çº§ç‰ˆ) ---
        let commentInterval = null;
        const commentHistory = []; // è¯„è®ºç¼“å­˜æ± 
        let fetchCount = 0; // è¯·æ±‚è®¡æ•°å™¨
        
        function startFakeComments() {
            const bar = document.getElementById('comment-bar');
            bar.classList.add('show');
            // ä¸æ¸…ç©º barï¼Œä¿ç•™æ­£åœ¨æ»šåŠ¨çš„å¼¹å¹•
            
            if(commentInterval) clearInterval(commentInterval);
            
            // ç«‹å³æ¥ä¸€æ¡
            processComment();
            
            // æ¯ 2.5 ç§’æ¥ä¸€æ¡ (é¢‘ç‡åŠ å¿«)
            commentInterval = setInterval(processComment, 2500);
        }

        async function processComment() {
            // å¦‚æœè¯·æ±‚æ¬¡æ•°è¾¾åˆ°10æ¬¡ï¼Œå¼ºåˆ¶ä½¿ç”¨ç¼“å­˜ï¼Œä¸å†æ¶ˆè€—æµé‡
            if (fetchCount >= 10) {
                if (commentHistory.length > 0) {
                    const randomItem = commentHistory[Math.floor(Math.random() * commentHistory.length)];
                    renderComment(randomItem);
                }
                return;
            }

            // ç­–ç•¥ï¼š30% æ¦‚ç‡ä»ç¼“å­˜å–æ—§çš„ï¼ˆå¦‚æœç¼“å­˜æœ‰è´§ï¼‰ï¼Œ70% æ¦‚ç‡è¯·æ±‚æ–°çš„
            const useCache = commentHistory.length > 0 && Math.random() < 0.3;
            
            if (useCache) {
                const randomItem = commentHistory[Math.floor(Math.random() * commentHistory.length)];
                renderComment(randomItem);
            } else {
                await fetchNewComment();
            }
        }

        async function fetchNewComment() {
            if (fetchCount >= 10) return;

            try {
                // 1. éšæœºå¤´åƒ
                const userRes = await fetch('https://randomuser.me/api/?inc=name,picture&nat=us,cn');
                const userData = await userRes.json();
                const user = userData.results[0];
                
                // 2. éšæœºè¯­å½•
                let text = "";
                if(Math.random() > 0.5) {
                    const kRes = await fetch('https://api.kanye.rest/');
                    const kData = await kRes.json();
                    text = kData.quote;
                } else {
                    const hRes = await fetch('https://v1.hitokoto.cn/?c=a&c=b&c=c');
                    const hData = await hRes.json();
                    text = hData.hitokoto;
                }

                const commentData = {
                    name: user.name.first,
                    avatar: user.picture.thumbnail,
                    text: text
                };

                // å­˜å…¥ç¼“å­˜
                commentHistory.push(commentData);
                fetchCount++; // æˆåŠŸä¸€æ¬¡ï¼Œè®¡æ•°åŠ ä¸€
                // é™åˆ¶ç¼“å­˜å¤§å°ï¼Œé˜²æ­¢å†…å­˜æº¢å‡º (æ¯”å¦‚ä¿ç•™æœ€è¿‘50æ¡)
                if(commentHistory.length > 50) commentHistory.shift();

                renderComment(commentData);
                
            } catch(e) {
                // å¤±è´¥äº†å°±å°è¯•ç”¨ç¼“å­˜å…œåº•
                if(commentHistory.length > 0) {
                    const randomItem = commentHistory[Math.floor(Math.random() * commentHistory.length)];
                    renderComment(randomItem);
                }
            }
        }

        function renderComment(data) {
            const bar = document.getElementById('comment-bar');
            const item = document.createElement('div');
            item.className = 'comment-item';
            item.innerHTML = `
                <img src="${data.avatar}" class="comment-avatar">
                <span style="color:#ffeb3b; font-weight:bold;">${data.name}:</span>
                <span>${data.text}</span>
            `;
            
            // éšæœºå‚ç›´ä½ç½® (0% - 70%)ï¼Œé˜²æ­¢é‡å 
            const randomTop = Math.floor(Math.random() * 70);
            item.style.top = randomTop + '%';
            
            // éšæœºé€Ÿåº¦ (10s - 18s)
            const randomDuration = 10 + Math.random() * 8;
            item.style.animationDuration = randomDuration + 's';

            // åŠ¨ç”»ç»“æŸåç§»é™¤ DOM å…ƒç´  (ä½†æ•°æ®è¿˜åœ¨ history é‡Œ)
            item.onanimationend = () => {
                item.remove();
            };
            
            bar.appendChild(item);
        }

        /* 2. ä¸­é—´å†…å®¹åŒº */
        .results-container {
            position: absolute;
            top: 70px;
            bottom: 90px;
            left: 0;
            width: 100%;
            overflow-y: auto;
            padding: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
            gap: 15px;
            z-index: 1;
        }

        .song-card {
            background: #282828;
            padding: 10px;
            border-radius: 6px;
            cursor: pointer;
            transition: 0.2s;
        }
        .song-card:active { transform: scale(0.98); }
        .song-card img {
            width: 100%;
            aspect-ratio: 1;
            object-fit: cover;
            border-radius: 4px;
            margin-bottom: 8px;
            background: #000;
        }
        .song-title {
            font-size: 14px;
            font-weight: bold;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            margin-bottom: 4px;
        }
        .song-artist {
            font-size: 12px;
            color: var(--light);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* 3. åº•éƒ¨æ’­æ”¾å™¨ */
        .player-bar {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 90px;
            background: #282828;
            border-top: 1px solid #444;
            z-index: 100;
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0 15px;
            box-shadow: 0 -2px 10px rgba(0,0,0,0.5);
        }

        .now-playing { display: flex; align-items: center; width: 35%; overflow: hidden; }
        .now-playing img {
            width: 50px; height: 50px; border-radius: 50%;
            margin-right: 10px; border: 2px solid #111;
            animation: rotate 10s linear infinite; animation-play-state: paused;
        }
        .now-playing img.playing { animation-play-state: running; }
        @keyframes rotate { from {transform: rotate(0deg);} to {transform: rotate(360deg);} }
        .track-info { display: flex; flex-direction: column; overflow: hidden; }
        .track-info .name { font-size: 13px; font-weight: bold; white-space: nowrap; }
        .track-info .artist { font-size: 11px; color: var(--light); white-space: nowrap; }

        .controls { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .play-btn {
            width: 36px; height: 36px; border-radius: 50%; border: none;
            background: var(--white); color: black; font-size: 16px;
            cursor: pointer; margin-bottom: 6px; display: flex; 
            align-items: center; justify-content: center;
        }
        .progress-area { width: 100%; max-width: 300px; display: flex; align-items: center; gap: 8px; font-size: 10px; color: var(--light); }
        #progress-bar { flex: 1; height: 4px; background: #555; border-radius: 2px; cursor: pointer; position: relative; }
        #progress-fill { height: 100%; background: var(--primary); width: 0%; border-radius: 2px; }

        .extras { width: 25%; display: flex; justify-content: flex-end; }
        .lyrics-btn {
            background: transparent; border: 1px solid #666; color: var(--light);
            padding: 4px 10px; border-radius: 12px; font-size: 12px; cursor: pointer;
        }

        /* 4. æ­Œè¯é®ç½© */
        .lyrics-overlay {
            position: fixed; top: 70px; bottom: 90px; left: 0; width: 100%;
            background: rgba(0,0,0,0.95); z-index: 80; display: none;
            flex-direction: column; align-items: center; padding: 40px 20px;
            text-align: center; overflow-y: auto;
        }
        .lyrics-overlay.show { display: flex; }
        .close-lyrics { position: absolute; top: 10px; right: 15px; background: none; border: none; color: #666; font-size: 28px; cursor: pointer; }
        .lyrics-content { white-space: pre-wrap; line-height: 2; color: #ddd; font-size: 16px; margin-top: 20px; }

    </style>
</head>
<body>

    <!-- 1. é¡¶éƒ¨æœç´¢ -->
    <div class="search-container">
        <input type="text" id="search-input" placeholder="è¾“å…¥æ­Œæ‰‹æˆ–æ­Œæ›²å..." value="">
        <button class="btn search-btn" onclick="searchMusic()">æœç´¢</button>
        <!-- æ–°å¢éšæœºæŒ‰é’® -->
        <button class="btn random-btn" onclick="randomSearch()" title="éšæœºæ¨èä¸€ä¸ªå…³é”®è¯">
            <span>ğŸ²</span>
        </button>
        <!-- æ–°å¢å¤©æ°”æŒ‰é’® -->
        <button class="btn weather-btn" onclick="searchByWeather()" title="çœ‹å¤©å¬æ­Œ">
            <span>ğŸŒ¤</span>
        </button>
    </div>

    <!-- 2. ä¸­é—´åˆ—è¡¨ -->
    <div class="results-container" id="results">
        <div style="text-align:center; padding-top:50px; color:#555; grid-column:1/-1;">
            ç‚¹å‡» ğŸ² è¯•è¯•æ‰‹æ°”ï¼Œæˆ–è€…è¾“å…¥å…³é”®è¯æœç´¢
        </div>
    </div>

    <!-- 3. æ­Œè¯é®ç½© -->
    <div class="lyrics-overlay" id="lyrics-overlay">
        <button class="close-lyrics" onclick="toggleLyrics()">Ã—</button>
        <h3 id="lyrics-title" style="color:var(--primary); margin-bottom:10px;"></h3>
        <!-- æ­Œæ‰‹ç™¾ç§‘å®¹å™¨ -->
        <div id="artist-wiki" class="artist-wiki"></div>
        <div class="lyrics-content" id="lyrics-text">æ­Œè¯åŠ è½½ä¸­...</div>
    </div>

    <!-- å¼¹å¹•æ¡ -->
    <div class="comment-bar" id="comment-bar">
        <!-- åŠ¨æ€æ’å…¥è¯„è®º -->
    </div>

    <!-- 4. åº•éƒ¨æ’­æ”¾å™¨ -->
    <div class="player-bar">
        <audio id="audio-player"></audio>
        <div class="now-playing">
            <img id="player-cover" src="https://via.placeholder.com/50" alt="CD">
            <div class="track-info">
                <div class="name" id="player-name">æå®¢éŸ³ä¹</div>
                <div class="artist" id="player-artist">Ready to play</div>
            </div>
        </div>
        <div class="controls">
            <button class="play-btn" onclick="togglePlay()" id="play-btn">â–¶</button>
            <div class="progress-area">
                <span id="curr-time">0:00</span>
                <div id="progress-bar" onclick="seek(event)"><div id="progress-fill"></div></div>
                <span id="total-time">0:30</span>
            </div>
        </div>
        <div class="extras">
            <button class="lyrics-btn" onclick="toggleLyrics()">è¯</button>
        </div>
    </div>

    <script>
        const audio = document.getElementById('audio-player');
        const resultsDiv = document.getElementById('results');
        const lyricsOverlay = document.getElementById('lyrics-overlay');
        const playBtn = document.getElementById('play-btn');
        const searchInput = document.getElementById('search-input');
        
// --- 1000 ä¸ªéšæœºéŸ³ä¹æœç´¢å…³é”®è¯åº“ ---
const keywords = [
  // æƒ…æ„Ÿ & çŠ¶æ€
  "Love", "Happy", "Sad", "Lonely", "Crazy", "Beautiful", "Memory", "Forever", "Heart", "Soul",
  "Dream", "Kiss", "Miss", "Baby", "Sorry", "Believe", "Free", "Smile", "Cry", "Hope",
  "Hate", "Broken", "Wild", "Sweet", "Sweetheart", "Pain", "Joy", "Tears", "Fear", "Faith",
  "Desire", "Despair", "Passion", "Paradise", "Heaven", "Hell", "Promise", "Truth", "Lies", "Secret",
  "Lost", "Found", "Alone", "Together", "Stronger", "Weaker", "Brave", "Shy", "Proud", "Ashamed",
  "Jealous", "Envy", "Regret", "Blessing", "Curse", "Wish", "Magic", "Miracle", "Comfort", "Silence",
  "Freedom", "Control", "Chaos", "Order", "Light", "Dark", "Shadow", "Bright", "Cold", "Warm",
  "Calm", "Angry", "Mad", "Crazy Love", "True Love", "First Love", "Last Love", "Young Love", "Endless Love", "Secret Love",
  "Heartbreak", "Heartache", "Heartbeat", "Heartbeat Love", "Deep Love", "Deep Feelings", "Inner Voice", "Inner Fire", "Soulmate", "Soul Love",

  // æ—¶é—´ & çºªå¿µ
  "Night", "Summer", "Rain", "Sky", "Ocean", "Sun", "Moon", "Star", "Fire", "Ice",
  "California", "New York", "London", "Tokyo", "Paris", "Home", "Road", "City", "World", "Space",
  "Yesterday", "Tomorrow", "Today", "Tonight", "Morning", "Midnight", "Noon", "Sunrise", "Sunset", "Dawn",
  "Weekend", "Holiday", "Winter", "Autumn", "Spring", "Summer Night", "Summer Love", "Summer Rain", "Winter Night", "Winter Love",
  "New Year", "Birthday", "Anniversary", "First Time", "Last Night", "One Day", "Someday", "One More Time", "One More Night", "One More Chance",
  "Moment", "Forever Night", "Forever Young", "Young & Wild", "Old Days", "Good Old Days", "Golden Days", "Better Days", "Dark Days", "End Of Time",

  // è‡ªç„¶ & åœºæ™¯
  "River", "Mountain", "Forest", "Desert", "Island", "Beach", "Sea", "Storm", "Thunder", "Lightning",
  "Wind", "Snow", "Rainbow", "Cloud", "Galaxy", "Universe", "Street", "Highway", "Bridge", "Valley",
  "Garden", "Field", "Castle", "Palace", "Jungle", "Harbor", "Harbour", "Harbor Lights", "Harbor Night", "Ocean Waves",
  "City Lights", "Neon Lights", "Skyline", "Backstreet", "Downtown", "Uptown", "Subway", "Train", "Station", "Airport",
  "Hotel", "Motel", "Bar", "Club", "Cafe", "Restaurant", "Room", "Bedroom", "Living Room", "Kitchen",
  "Rooftop", "Basement", "Balcony", "Window", "Door", "Bridge To Heaven", "Bridge Of Love", "Long Road", "Lonely Road", "Open Road",

  // æ—…é€” & è¿åŠ¨
  "Road Trip", "Journey", "Travel", "Run", "Fly", "Walk", "Talk", "Touch", "Feel", "Stop",
  "Go", "Stay", "Leave", "Return", "Come Back", "Turn Back", "Turn Around", "Drive", "Ride", "Sail",
  "Flight", "Escape", "Chase", "Hunt", "Race", "Race Car", "Highway Night", "Highway Star", "Freeway", "Crossroads",
  "Border", "Borderline", "Checkpoint", "Destination", "Nowhere", "Anywhere", "Somewhere", "Far Away", "Close To You", "Next To Me",

  // é£æ ¼ & æŠ½è±¡
  "Rock", "Jazz", "Blues", "Pop", "Disco", "Dance", "Party", "Magic", "Power", "Glory",
  "King", "Queen", "Angel", "Devil", "Hero", "Legend", "Life", "Time", "Yesterday", "Tomorrow",
  "Funk", "Soul Music", "R&B", "Hip Hop", "Rap", "Trap", "House", "Techno", "Trance", "Dubstep",
  "Electro", "Indie", "Alternative", "Metal", "Punk", "Classic", "Symphony", "Opera", "Ballad", "Acoustic",
  "Chill", "Chillout", "Lo-Fi", "LoFi", "Ambient", "Instrumental", "Cover", "Remix", "Mashup", "Live",
  "Unplugged", "Acoustic Live", "Studio", "Mixtape", "Playlist", "Session", "Jam", "Freestyle", "Battle", "Showtime",

  // é¢œè‰²
  "Blue", "Red", "Yellow", "Black", "White", "Pink", "Green", "Gold", "Silver", "Purple",
  "Orange", "Brown", "Gray", "Grey", "Violet", "Indigo", "Scarlet", "Crimson", "Emerald", "Sapphire",
  "Golden", "Golden Heart", "Golden Night", "Golden Sky", "Black Night", "Black Heart", "Black Rose", "Blue Sky", "Blue Moon", "Blue Night",
  "Red Rose", "Red Moon", "White Night", "White Rose", "Pink Sky", "Pink Love", "Green Light", "Neon", "Neon Love", "Neon Night",

  // èº«ä»½ & è§’è‰²
  "Stranger", "Friend", "Best Friend", "Enemy", "Lover", "Dreamer", "Believer", "Dancer", "Singer", "Player",
  "Warrior", "Soldier", "Rebel", "Outlaw", "Angel Eyes", "Fallen Angel", "Dark Angel", "Guardian Angel", "King Of Hearts", "Drama Queen",
  "Heartbreaker", "Storyteller", "Runner", "Rider", "Fighter", "Survivor", "Winner", "Loser", "Champion", "Starboy",
  "Good Girl", "Bad Girl", "Good Boy", "Bad Boy", "Lonely Boy", "Lonely Girl", "City Boy", "City Girl", "Wild Boy", "Wild Girl",

  // è¡Œä¸º & åŠ¨ä½œ
  "Kiss Me", "Hold Me", "Touch Me", "Feel Me", "Call Me", "Call Me Maybe", "Catch Me", "Save Me", "Need You", "Miss You",
  "Love You", "Hate You", "Without You", "With You", "For You", "About You", "By Your Side", "Next To You", "Over You", "Under You",
  "Let Go", "Let Me Go", "Let It Go", "Carry On", "Move On", "Turn Up", "Turn Down", "Slow Down", "Speed Up", "Wake Up",
  "Stay With Me", "Stay", "Don't Go", "Don't Stop", "Don't Leave", "Come On", "Come Home", "Come Closer", "Hold On", "Hold Tight",

  // æŠ½è±¡ & æ¦‚å¿µ
  "Dreams", "Nightmare", "Fantasy", "Illusion", "Vision", "Destiny", "Fate", "Chance", "Luck", "Karma",
  "Shadow Of Love", "Shadow Of The Night", "Echoes", "Memories", "Flashback", "Afterglow", "Reborn", "Rebirth", "Revival", "Awakening",
  "Addiction", "Obsession", "Temptation", "Salvation", "Redemption", "Revolution", "Evolution", "Change", "Transformation", "Metamorphosis",
  "Infinity", "Eternity", "Zero", "One", "Million", "Million Reasons", "Million Dreams", "Thousand Miles", "Thousand Years", "Hundred Days",

  // ç»å…¸è‰ºäºº/ä¹é˜Ÿ (åªä½œæœç´¢å…³é”®è¯ï¼Œä¸æ¶‰åŠä»»ä½•éå…¬å¼€ä¿¡æ¯)
  "Beatles", "Queen", "Jackson", "Taylor", "Adele", "Coldplay", "Ed Sheeran", "Eminem", "Rihanna", "Beyonce",
  "Bruno Mars", "Justin", "Linkin Park", "Nirvana", "Elvis", "Madonna", "Drake", "Weeknd", "Gaga", "Maroon 5",
  "Kanye", "Swift", "Billie", "Dua Lipa", "Ariana", "Shakira", "Whitney", "Mariah", "Celine", "Katy Perry",
  "Imagine Dragons", "OneRepublic", "Fall Out Boy", "Green Day", "Red Hot Chili Peppers", "Metallica", "ACDC", "U2", "Oasis", "Blur",
  "Radiohead", "Muse", "The Killers", "Paramore", "Linkin", "Backstreet Boys", "NSYNC", "Spice Girls", "ABBA", "Bee Gees",

  // ä¹å™¨ & å£°éŸ³
  "Guitar", "Electric Guitar", "Acoustic Guitar", "Piano", "Grand Piano", "Keyboard", "Bass", "Drums", "Violin", "Cello",
  "Saxophone", "Trumpet", "Trombone", "Flute", "Clarinet", "Harp", "Ukulele", "Banjo", "Harmonica", "Organ",
  "Synth", "Synthwave", "808", "Beat", "Beats", "Rhythm", "Melody", "Harmony", "Chords", "Bassline",
  "Choir", "Voice", "Vocal", "Whisper", "Shout", "Scream", "Echo", "Reverb", "Silence Sound", "Noise",
  "Heartbeat Sound", "Drum & Bass", "Guitar Solo", "Piano Man", "Piano Girl", "Rock Guitar", "Jazz Piano", "Sax Solo", "Violin Song", "String Quartet",

  // æ´¾å¯¹ & åœºåˆ
  "Party", "Birthday Party", "House Party", "Beach Party", "Pool Party", "After Party", "Night Club", "Dance Floor", "Festival", "Carnival",
  "Parade", "Rave", "Concert", "Tour", "World Tour", "Live Show", "Opening Night", "Closing Time", "Night Out", "Girls Night",
  "Boys Night", "Saturday Night", "Friday Night", "Sunday Morning", "Weekend Party", "Midnight Party", "Club Night", "Bar Night", "Bar Song", "Drinking Song",

  // å…³ç³» & æ•…äº‹
  "Love Story", "Sad Story", "True Story", "Our Story", "My Story", "Your Story", "Story Of My Life", "Story Of Us", "Broken Story", "Fairytale",
  "Fairy Tale", "Happy Ending", "Sad Ending", "New Beginning", "Fresh Start", "First Date", "Blind Date", "One Night", "One Night Stand", "Secret Night",
  "Secret Lover", "Forbidden Love", "Hidden Love", "Long Distance", "Long Distance Love", "Best Friend Love", "Friends Forever", "Friends To Lovers", "More Than Friends", "No More Tears",

  // æ•°å­— & çŸ­è¯­
  "One Kiss", "Two Hearts", "Three Words", "Four Seasons", "Five Nights", "Seven Days", "Ten Years", "24 Hours", "365 Days", "24 7",
  "First Kiss", "Second Chance", "Third Eye", "Lucky One", "Lucky Star", "Lucky Day", "Number One", "Top Ten", "Level Up", "Next Level",
  "Zero Gravity", "Room 101", "Room 303", "Area 51", "High Five", "Midnight Train", "Midnight Sky", "Midnight City", "2AM", "3AM",

  // ç”Ÿæ´» & ç°å®
  "Money", "Work", "School", "Friend", "Best", "Good", "Bad", "High", "Low", "Christmas",
  "Job", "Boss", "Office", "College", "Campus", "Homework", "Exam", "Graduation", "Taxi", "Subway Train",
  "Coffee", "Tea", "Wine", "Whiskey", "Beer", "Cigarettes", "Smoke", "Traffic", "Rush Hour", "Payday",
  "Broke", "Rich", "Millionaire", "Street Life", "City Life", "Night Life", "Love Life", "Double Life", "Secret Life", "New Life",

  // èŠ‚æ—¥ & æ°›å›´
  "Christmas Night", "Christmas Love", "Christmas Eve", "Silent Night", "New Year Party", "New Year Love", "Valentine", "Valentine's Day", "Halloween Night", "Halloween Party",
  "Easter", "Spring Break", "Summer Break", "Winter Wonderland", "Snowfall", "Snow Night", "Snow Love", "Rainy Day", "Rainy Night", "Stormy Night",
  "Fireworks", "Lanterns", "Midnight Fireworks", "Festival Lights", "Summer Festival", "Music Festival", "Love Festival", "Carnival Night", "Carnival Love", "Holiday Love",

  // ç½‘ç»œ & æ•°å­—æ„Ÿ
  "Internet", "Online", "Offline", "WiFi", "Bluetooth", "Digital Love", "Virtual Love", "Virtual Reality", "Fantasy World", "Cyber Love",
  "Screen", "Timeline", "News Feed", "Notification", "Message", "DM", "Inbox", "Outbox", "Voice Mail", "Hotline",
  "Stream", "Streaming", "Playlist Love", "Shuffle", "Repeat", "Replay", "Rewind", "Fast Forward", "Skip", "Play Button",

  // åŠ±å¿— & æ­£èƒ½é‡
  "Never Give Up", "Stand Up", "Rise Up", "Wake Up Call", "Stronger Than Ever", "Born To Run", "Born To Die", "Born This Way", "Born For You", "Born Again",
  "Fight For Love", "Fight For You", "Fight For Life", "Believe In Me", "Believe In You", "Believe In Love", "Chasing Dreams", "Chasing Stars", "Chasing Cars", "Reach For The Sky",
  "Higher", "Higher Ground", "On Top", "Top Of The World", "Sky High", "Limitless", "No Limits", "No Fear", "Fearless", "Unstoppable",

  // å¤±è½ & emo
  "Broken Dreams", "Broken Wings", "Broken Heart", "Broken Love", "Empty Heart", "Empty Room", "Empty Streets", "Lonely Night", "Lonely Road", "Lonely World",
  "Fade Away", "Fall Apart", "Falling Down", "Falling", "Drowning", "Bleeding Love", "Crying In The Rain", "Tears In Heaven", "Tears Of Love", "Nothing Left",
  "Nowhere To Go", "Lost In You", "Lost In Love", "Lost In The Dark", "Lost In The Night", "Missing You", "Miss You So", "Need You Now", "Without Me", "Without Love",

  // èŠ‚å¥ & èˆè¹ˆ
  "Dance With Me", "Dance All Night", "Last Dance", "Slow Dance", "Fast Dance", "Midnight Dance", "Crazy Dance", "Dance In The Dark", "Dance In The Rain", "Dance In The Moonlight",
  "Rhythm Of The Night", "Rhythm Of Love", "Rhythm Divine", "Feel The Beat", "Drop The Beat", "Drop It", "Turn The Music Up", "Turn The Music On", "Turn The Lights Down", "Turn The Lights Off",
  "Move Your Body", "Shake It", "Hands Up", "Hands Down", "Jump", "Jump Around", "Step By Step", "Two Step", "Footloose", "Groove",

  // æŠ½è±¡è‹±æ–‡çŸ­è¯­ (å¾ˆé€‚åˆæœæ­Œ)
  "Into The Night", "Into The Sky", "Into The Wild", "Into You", "Into The Dark", "Out Of Love", "Out Of Time", "Out Of Control", "Out Of My Mind", "Out Of The Blue",
  "All Of Me", "All Of You", "All Of Us", "All My Life", "All My Love", "All Night", "All Day", "All The Time", "For The First Time", "For The Last Time",
  "Just The Way You Are", "Just A Dream", "Just A Kiss", "Just Like Heaven", "Just Like You", "Only You", "Only Love", "Only One", "One And Only", "One More Try",

  // åŸå¸‚ & åœ°ç‚¹ï¼ˆè¡¥å……ï¼‰
  "Miami", "Los Angeles", "Chicago", "Houston", "Seattle", "Boston", "Berlin", "Rome", "Barcelona", "Madrid",
  "Amsterdam", "Moscow", "Hong Kong", "Shanghai", "Beijing", "Seoul", "Bangkok", "Sydney", "Melbourne", "Rio",
  "Vegas", "Las Vegas", "Hawaii", "Ibiza", "Brooklyn", "Bronx", "Harlem", "Soho", "Hollywood", "Broadway",

  // æŠ¼éŸµ & å¸¸è§å•è¯ç»„åˆ
  "Fire And Ice", "Fire And Rain", "Fire In The Sky", "Fire In My Heart", "Rain And Thunder", "Rain On Me", "Snow And Ice", "Sun And Moon", "Sun And Rain", "Moon And Back",
  "Hearts And Bones", "Hearts On Fire", "Hearts Of Gold", "Tears And Rain", "Salt And Pepper", "Sugar And Spice", "Wine And Roses", "Blood And Tears", "Blood And Wine", "Blood On The Dance Floor",

  // è½»æ¾ & ç”Ÿæ´»å‘³
  "Chill Vibes", "Good Vibes", "Summer Vibes", "Beach Vibes", "Night Vibes", "City Vibes", "Love Vibes", "Sad Vibes", "LoFi Vibes", "Coffee Break",
  "Morning Coffee", "Night Coffee", "Midnight Coffee", "Sunset Drive", "Midnight Drive", "Night Drive", "City Drive", "Late Night", "Late Night Call", "Late Night Drive",
  "Lazy Sunday", "Sunday Morning", "Sunday Night", "Monday Blues", "Friday Feeling", "Friday Night Lights", "Saturday Love", "Saturday Night Fever", "Weekend Love", "Weekend Mood",

  // é¢å¤–å¸¸è§è‹±æ–‡æ­Œåå…ƒç´ 
  "Beautiful Day", "Beautiful Girl", "Beautiful Boy", "Beautiful Life", "Beautiful World", "Crazy In Love", "Crazy For You", "Crazy Night", "Crazy World", "End Of The World",
  "Shape Of You", "Thinking Of You", "Thinking Out Loud", "Back To You", "Back To Black", "Back To Life", "Back Home", "Back In Time", "Stay With You", "Stay The Night",
  "Say You Love Me", "Say Something", "Say My Name", "Call My Name", "Call Your Name", "Kiss The Rain", "Walk On Water", "Walk Away", "Runaway", "Runaway Love",
  "Take Me Home", "Take Me Back", "Take It Easy", "Take It Slow", "Take On Me", "Let Me Love You", "Let Me In", "Let It Be", "Let It Rain", "Let It Shine",

  // å¤‡ç”¨ / æ‚é¡¹é«˜é¢‘è¯
  "Sky", "Stars", "Moonlight", "Starlight", "Spotlight", "Headlights", "City Lights", "Bright Lights", "Street Lights", "Northern Lights",
  "Angel Of Mine", "Devil Inside", "Hero Of War", "Local Hero", "Teenage Dream", "Teenage Love", "Teenage Heart", "Teenage Riot", "Teen Spirit", "Broken Spirit",
  "Wild Heart", "Wild Dreams", "Wild Nights", "Wild Things", "Wild World", "Sweet Dreams", "Sweet Home", "Sweet Child", "Sweet Life", "Sweet Escape",
  "Golden Hour", "Midnight Hour", "Rush Of Blood", "Signs", "Signals", "Codes", "Secret Code", "Password", "Key To My Heart", "Key To The City"
];

        let currentTrack = null;

        // --- éšæœºæœç´¢åŠŸèƒ½ ---
        function randomSearch() {
            // 1. éšæœºå–ä¸€ä¸ªè¯
            const randomIndex = Math.floor(Math.random() * keywords.length);
            const word = keywords[randomIndex];
            
            // 2. å¡«å…¥æœç´¢æ¡†
            searchInput.value = word;
            
            // 3. è§¦å‘æœç´¢
            searchMusic();
        }

        async function searchMusic() {
            const query = searchInput.value;
            if(!query) return;

            resultsDiv.innerHTML = '<div style="text-align:center; padding:20px; color:#888; grid-column:1/-1;">æ­£åœ¨è¿æ¥ iTunes...</div>';

            try {
                const res = await fetch(`https://itunes.apple.com/search?term=${encodeURIComponent(query)}&entity=song&limit=24`);
                const data = await res.json();
                renderResults(data.results);
            } catch (e) {
                resultsDiv.innerHTML = `<div style="color:red; text-align:center; grid-column:1/-1;">ç½‘ç»œé”™è¯¯ (Error: ${e.message})</div>`;
            }
        }

        function renderResults(songs) {
            resultsDiv.innerHTML = '';
            if(songs.length === 0) {
                resultsDiv.innerHTML = '<div style="text-align:center; padding:20px; color:#888; grid-column:1/-1;">æœªæ‰¾åˆ°ç›¸å…³æ­Œæ›²</div>';
                return;
            }

            songs.forEach(song => {
                const highResImage = song.artworkUrl100.replace('100x100bb', '300x300bb');
                const card = document.createElement('div');
                card.className = 'song-card';
                // ç‚¹å‡»å¡ç‰‡é»˜è®¤æ’­æ”¾é¢„è§ˆ
                card.onclick = () => playSong(song, highResImage);

                card.innerHTML = `
                    <img src="${highResImage}" loading="lazy">
                    <div class="song-title" style="cursor:pointer; text-decoration:underline; color:var(--primary);" title="åœ¨ Apple Music ä¸­æ‰“å¼€">
                        ${song.trackName} 
                    </div>
                    <div class="song-artist">${song.artistName}</div>
                `;

                // è·å–æ ‡é¢˜å…ƒç´ å¹¶ç»‘å®šç‹¬ç«‹ç‚¹å‡»äº‹ä»¶
                const titleEl = card.querySelector('.song-title');
                titleEl.onclick = (e) => {
                    e.stopPropagation(); // é˜»æ­¢å†’æ³¡
                    
                    // æ™ºèƒ½åˆ¤æ–­è®¾å¤‡ç±»å‹
                    const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
                    
                    if (isMobile) {
                        // ç§»åŠ¨ç«¯ï¼šç›´æ¥è·³è½¬ï¼Œé¿å…ç•™å­˜ç©ºç™½é¡µï¼Œå¹¶èƒ½å”¤èµ· App
                        window.location.href = song.trackViewUrl;
                    } else {
                        // æ¡Œé¢ç«¯ï¼šæ–°æ ‡ç­¾é¡µæ‰“å¼€ï¼Œä¿ç•™å½“å‰æ’­æ”¾å™¨ä¸è¢«è¦†ç›–
                        window.open(song.trackViewUrl, '_blank');
                    }
                };

                resultsDiv.appendChild(card);
            });
        }

        function playSong(song, imageUrl) {
            currentTrack = song;
            document.getElementById('player-name').innerText = song.trackName;
            document.getElementById('player-artist').innerText = song.artistName;
            document.getElementById('player-cover').src = imageUrl;
            
            audio.src = song.previewUrl;
            audio.play();
            updatePlayBtnState(true);
            
            document.getElementById('lyrics-title').innerText = song.trackName;
            document.getElementById('lyrics-text').innerText = "æ­£åœ¨æœç´¢æ­Œè¯...";
            
            // æ¸…ç©ºå¹¶éšè—ä¹‹å‰çš„ç™¾ç§‘
            const wikiDiv = document.getElementById('artist-wiki');
            wikiDiv.innerHTML = '';
            wikiDiv.classList.remove('show');
            
            fetchLyrics(song.artistName, song.trackName);
            fetchArtistInfo(song.artistName); // è·å–æ­Œæ‰‹ç™¾ç§‘
            
            // å¼€å¯å¼¹å¹•
            startFakeComments();
        }

        // --- åˆ›æ„1: çœ‹å¤©å¬æ­Œ ---
        async function searchByWeather() {
            const btn = document.querySelector('.weather-btn');
            const originalText = btn.innerHTML;
            btn.innerHTML = 'âŒ›'; // Loading state
            
            try {
                // 1. è·å–ä½ç½® (æ›´æ¢ä¸ºæ”¯æŒ HTTPS çš„ GeoJS)
                const geoRes = await fetch('https://get.geojs.io/v1/ip/geo.json');
                const geo = await geoRes.json();
                
                // 2. æŸ¥å¤©æ°” (Open-Meteo)
                // GeoJS è¿”å›çš„æ˜¯ latitude å’Œ longitude (å­—ç¬¦ä¸²ç±»å‹ï¼Œä½†å¯ä»¥ç›´æ¥æ‹¼æ¥åˆ° URL)
                const weatherRes = await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${geo.latitude}&longitude=${geo.longitude}&current_weather=true`);
                const weatherData = await weatherRes.json();
                const wcode = weatherData.current_weather.weathercode;
                
                // 3. æ˜ å°„å…³é”®è¯
                let keyword = "Pop";
                let weatherDesc = "æœªçŸ¥å¤©æ°”";
                
                if (wcode <= 3) { keyword = "Sunny Beach"; weatherDesc = "æ™´æœ—"; }
                else if (wcode >= 45 && wcode <= 48) { keyword = "Foggy Jazz"; weatherDesc = "é›¾å¤©"; }
                else if (wcode >= 51 && wcode <= 67) { keyword = "Rainy Mood"; weatherDesc = "ä¸‹é›¨"; }
                else if (wcode >= 71) { keyword = "Winter Snow"; weatherDesc = "ä¸‹é›ª"; }
                else if (wcode >= 95) { keyword = "Thunderstorm"; weatherDesc = "é›·æš´"; }
                else { keyword = "Cloudy Chill"; weatherDesc = "å¤šäº‘"; }

                // 4. æœç´¢
                searchInput.value = keyword;
                searchMusic();
                alert(`å½“å‰ä½ç½®: ${geo.city}\nå¤©æ°”: ${weatherDesc} (Code: ${wcode})\nä¸ºä½ æ¨è: ${keyword}`);
                
            } catch (e) {
                alert("è·å–å¤©æ°”å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œæˆ–å®šä½æƒé™");
                console.error(e);
            } finally {
                btn.innerHTML = originalText;
            }
        }

        // --- åˆ›æ„2: æ­Œæ‰‹å°ç™¾ç§‘ ---
        async function fetchArtistInfo(artistName) {
            // æ¸…ç†åå­—ï¼Œå»æ‰ feat. ç­‰åç¼€ï¼Œåªå–ç¬¬ä¸€ä¸ªåå­—
            // å¢åŠ å¯¹ä¸­æ–‡çš„å¤„ç†ï¼Œå¦‚æœæ˜¯ä¸­æ–‡åï¼Œç›´æ¥æœ
            let cleanName = artistName.split(/&|,|feat\.|ft\./)[0].trim();
            
            // å°è¯•ä¸­æ–‡ç»´åŸº
            let url = `https://zh.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(cleanName)}`;
            
            try {
                let res = await fetch(url);
                if(!res.ok) {
                    // å¦‚æœä¸­æ–‡æ²¡æœåˆ°ï¼Œè¯•ä¸€ä¸‹è‹±æ–‡ç»´åŸº (é’ˆå¯¹è‹±æ–‡å)
                    url = `https://en.wikipedia.org/api/rest_v1/page/summary/${encodeURIComponent(cleanName)}`;
                    res = await fetch(url);
                }
                
                if(res.ok) {
                    const data = await res.json();
                    if (data.extract) {
                        const wikiDiv = document.getElementById('artist-wiki');
                        const wikiLink = data.content_urls && data.content_urls.desktop ? data.content_urls.desktop.page : '#';
                        
                        wikiDiv.innerHTML = `
                            <strong style="color:var(--primary)">${data.title} å°ç™¾ç§‘:</strong><br>
                            ${data.extract}
                            <br><br>
                            <a href="${wikiLink}" target="_blank" style="color:var(--primary); text-decoration:underline; font-size:12px;">é˜…è¯»æ›´å¤š (Wikipedia) &rarr;</a>
                        `;
                        wikiDiv.classList.add('show');
                    }
                }
            } catch (e) {
                console.log("Wiki info not found");
            }
        }

        // --- åˆ›æ„4: ä¼ªÂ·å¼¹å¹•è¯„è®ºåŒº ---
        let commentInterval = null;
        
        function startFakeComments() {
            const bar = document.getElementById('comment-bar');
            bar.classList.add('show');
            bar.innerHTML = ''; // æ¸…ç©ºæ—§çš„
            
            if(commentInterval) clearInterval(commentInterval);
            
            // ç«‹å³æ¥ä¸€æ¡
            addComment();
            
            // æ¯ 4 ç§’æ¥ä¸€æ¡
            commentInterval = setInterval(addComment, 4000);
        }

        async function addComment() {
            const bar = document.getElementById('comment-bar');
            
            try {
                // 1. éšæœºå¤´åƒ
                const userRes = await fetch('https://randomuser.me/api/?inc=name,picture&nat=us,cn');
                const userData = await userRes.json();
                const user = userData.results[0];
                const userName = user.name.first;
                const userAvatar = user.picture.thumbnail;
                
                // 2. éšæœºè¯­å½• (50% æ¦‚ç‡ Kanye, 50% æ¦‚ç‡ ä¸€è¨€)
                let text = "";
                if(Math.random() > 0.5) {
                    // Kanye
                    const kRes = await fetch('https://api.kanye.rest/');
                    const kData = await kRes.json();
                    text = kData.quote;
                } else {
                    // Hitokoto (ä¸€è¨€)
                    const hRes = await fetch('https://v1.hitokoto.cn/?c=a&c=b&c=c'); // åŠ¨ç”»ã€æ¼«ç”»ã€æ¸¸æˆç±»
                    const hData = await hRes.json();
                    text = hData.hitokoto;
                }

                // 3. æ„å»º DOM
                const item = document.createElement('div');
                item.className = 'comment-item';
                item.innerHTML = `
                    <img src="${userAvatar}" class="comment-avatar">
                    <span style="color:#bbb">${userName}:</span>
                    <span>${text}</span>
                `;
                
                // æ¸…ç©ºä¹‹å‰çš„ï¼Œä¿æŒåªæœ‰ä¸€æ¡åœ¨æ»šåŠ¨ (æˆ–è€…ä½ å¯ä»¥åšå¤šæ¡)
                // è¿™é‡Œä¸ºäº†ç®€å•ï¼Œæˆ‘ä»¬æ¯æ¬¡æ¸…ç©ºï¼Œè®©å®ƒé‡æ–°æ»šåŠ¨
                bar.innerHTML = '';
                bar.appendChild(item);
                
            } catch(e) {
                console.log("Comment error", e);
            }
        }

        function togglePlay() {
            if(!audio.src) return;
            if(audio.paused) {
                audio.play();
                updatePlayBtnState(true);
            } else {
                audio.pause();
                updatePlayBtnState(false);
            }
        }

        function updatePlayBtnState(isPlaying) {
            playBtn.innerText = isPlaying ? 'â¸' : 'â–¶';
            const cover = document.getElementById('player-cover');
            if(isPlaying) cover.classList.add('playing');
            else cover.classList.remove('playing');
        }

        async function fetchLyrics(artist, title) {
            try {
                const cleanTitle = title.split('(')[0].split('-')[0].trim();
                const cleanArtist = artist.split('&')[0].split(',')[0].trim();
                const res = await fetch(`https://api.lyrics.ovh/v1/${cleanArtist}/${cleanTitle}`);
                if(!res.ok) throw new Error('No lyrics');
                const data = await res.json();
                if(data.lyrics) {
                    document.getElementById('lyrics-text').innerText = data.lyrics;
                } else {
                    showRandomCat();
                }
            } catch (e) {
                showRandomCat();
            }
        }

        async function showRandomCat() {
            const lyricsDiv = document.getElementById('lyrics-text');
            lyricsDiv.innerHTML = '<div style="margin-bottom:20px;">æš‚æ— æ­Œè¯ï¼Œæ­£åœ¨å¬å”¤çŒ«å’ª... ğŸ±</div>';
            
            try {
                const res = await fetch('https://api.thecatapi.com/v1/images/search');
                const data = await res.json();
                if(data && data[0] && data[0].url) {
                    lyricsDiv.innerHTML = `
                        <div style="background:rgba(255,255,255,0.05); border-radius:12px; padding:20px; max-width:90%; margin:0 auto; display:flex; flex-direction:column; align-items:center;">
                            <div style="margin-bottom:15px; color:var(--light); font-size:14px; line-height:1.5; text-align:center;">
                                æš‚æ— æ­Œè¯<br>ä½†è¿™é‡Œæœ‰ä¸€åªå¯çˆ±çš„çŒ«å’ªé™ªä½ å¬æ­Œ
                            </div>
                            <img src="${data[0].url}" style="max-width:100%; max-height:300px; width:auto; border-radius:8px; box-shadow:0 4px 12px rgba(0,0,0,0.3);" alt="Random Cat">
                        </div>
                    `;
                } else {
                    lyricsDiv.innerText = "æš‚æ— æ­Œè¯";
                }
            } catch(e) {
                lyricsDiv.innerText = "æš‚æ— æ­Œè¯";
            }
        }

        audio.ontimeupdate = () => {
            if(isNaN(audio.duration)) return;
            const percent = (audio.currentTime / audio.duration) * 100;
            document.getElementById('progress-fill').style.width = percent + '%';
            const curM = Math.floor(audio.currentTime / 60);
            const curS = Math.floor(audio.currentTime % 60);
            document.getElementById('curr-time').innerText = `${curM}:${curS<10?'0'+curS:curS}`;
        };

        function seek(e) {
            if(!audio.src) return;
            const bar = document.getElementById('progress-bar');
            const percent = e.offsetX / bar.clientWidth;
            audio.currentTime = percent * audio.duration;
        }

        function toggleLyrics() { lyricsOverlay.classList.toggle('show'); }
        searchInput.addEventListener('keypress', (e) => { if(e.key === 'Enter') searchMusic(); });

        // é¡µé¢åŠ è½½å®Œæˆåç«‹å³æœç´¢ï¼Œæ— éœ€ç­‰å¾…å›¾ç‰‡ç­‰èµ„æº
        document.addEventListener('DOMContentLoaded', randomSearch);

    </script>
</body>
</html>