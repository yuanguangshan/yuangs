<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>诗词解读</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link 
    href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;500;600;700&family=Inter:wght@400;500;600;700&display=swap"
    rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      /* Light theme variables */
      --xhs-pink: #FE2C55;
      --xhs-pink-light: #FF6B8A;
      --xhs-pink-lighter: #FFE5EB;
      --xhs-pink-pale: #FFF5F7;
      --bg-gradient-start: #FFFFFF;
      --bg-gradient-end: #FFF5F7;
      --bg-gradient-mid: #FFFAFC;
      --container-bg: rgba(255, 255, 255, 0.98);
      --container-shadow: rgba(254, 44, 85, 0.08);
      --header-gradient-start: #FE2C55;
      --header-gradient-end: #FF6B8A;
      --header-gradient-mid: #FE4569;
      --header-color: white;
      --text-primary: #333333;
      --text-secondary: #666666;
      --text-tertiary: #999999;
      --text-light: #BBBBBB;
      --bg-light: #FAFAFA;
      --bg-lighter: #F5F5F5;
      --border-color: #EEEEEE;
      --filter-bg: rgba(255, 255, 255, 0.95);
      --poem-desc-bg: rgba(255, 255, 255, 0.98);
      --poem-desc-border: #FE2C55;
      --search-result-bg: #FAFAFA;
      --search-result-hover: #FFF5F7;
      --refresh-btn-gradient-start: #FE2C55;
      --refresh-btn-gradient-end: #FF6B8A;
      --refresh-btn-color: white;
      --clear-btn-bg: #999999;
      --clear-btn-hover: #666666;
      --search-btn-bg: #FE2C55;
      --search-btn-hover: #E02548;
      --footer-color: #999999;
      --accent-glow: rgba(254, 44, 85, 0.2);
      --card-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
      --card-shadow-hover: 0 4px 20px rgba(254, 44, 85, 0.15);
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, var(--bg-gradient-start) 0%, var(--bg-gradient-mid) 50%, var(--bg-gradient-end) 100%);
      min-height: 100vh;
      padding: 20px;
      color: var(--text-primary);
      transition: background 0.5s ease;
    }

    .container {
      max-width: 1000px;
      margin: 0 auto;
      background: var(--container-bg);
      border-radius: 20px;
      box-shadow: var(--card-shadow);
      overflow: hidden;
      padding: 30px;
    }

    header {
      text-align: center;
      margin-bottom: 20px;
    }

    h1 {
      font-size: 1.8rem;
      margin-bottom: 8px;
      text-shadow: none;
      letter-spacing: 0.02em;
      font-weight: 600;
      font-family: 'Noto Serif SC', 'STSong', 'Songti SC', serif;
      color: var(--xhs-pink);
    }

    .subtitle {
      font-size: 0.95rem;
      opacity: 0.75;
      font-weight: 400;
      letter-spacing: 0.01em;
      color: var(--text-secondary);
    }

    .interpretation-content {
      line-height: 1.7;
      font-size: 1.1rem;
    }

    .interpretation-content h1,
    .interpretation-content h2,
    .interpretation-content h3,
    .interpretation-content h4,
    .interpretation-content h5,
    .interpretation-content h6 {
      margin-top: 1.5em;
      margin-bottom: 0.8em;
      color: var(--text-primary);
      font-family: 'Noto Serif SC', serif;
    }

    .interpretation-content h1 {
      font-size: 1.8em;
      border-bottom: 2px solid var(--xhs-pink-lighter);
      padding-bottom: 0.3em;
    }

    .interpretation-content h2 {
      font-size: 1.6em;
      border-bottom: 1px solid var(--border-color);
      padding-bottom: 0.3em;
    }

    .interpretation-content h3 {
      font-size: 1.4em;
    }

    .interpretation-content p {
      margin-bottom: 1em;
      text-align: justify;
    }

    .interpretation-content ul,
    .interpretation-content ol {
      margin: 1em 0;
      padding-left: 1.5em;
    }

    .interpretation-content li {
      margin: 0.5em 0;
    }

    .interpretation-content blockquote {
      margin: 1.5em 0;
      padding: 1em 1.5em;
      border-left: 4px solid var(--xhs-pink-lighter);
      background-color: var(--xhs-pink-pale);
      font-style: italic;
    }

    .interpretation-content code {
      background-color: var(--bg-light);
      padding: 0.2em 0.4em;
      border-radius: 3px;
      font-family: monospace;
      font-size: 0.9em;
    }

    .interpretation-content pre {
      background-color: var(--bg-light);
      padding: 1.5em;
      border-radius: 8px;
      overflow-x: auto;
      margin: 1.5em 0;
    }

    .interpretation-content pre code {
      background: none;
      padding: 0;
    }

    .interpretation-content a {
      color: #4da6ff;
      text-decoration: underline;
    }

    .interpretation-content a:hover {
      color: #66b3ff;
    }

    .copy-btn {
      position: fixed;
      top: 20px;
      right: 20px;
      background: linear-gradient(135deg, var(--refresh-btn-gradient-start) 0%, var(--refresh-btn-gradient-end) 100%);
      color: var(--refresh-btn-color);
      border: none;
      padding: 10px 15px;
      font-size: 1rem;
      border-radius: 5px;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: var(--card-shadow);
      font-weight: 500;
      z-index: 100;
    }

    .copy-btn:hover {
      transform: translateY(-2px);
      box-shadow: var(--card-shadow-hover);
    }

    .copy-btn:active {
      transform: translateY(0);
    }

    .poem-info {
      background: var(--bg-lighter);
      padding: 15px;
      border-radius: 10px;
      margin-bottom: 20px;
      border-left: 4px solid var(--xhs-pink);
    }

    .poem-info h2 {
      font-size: 1.2rem;
      margin-bottom: 10px;
      color: var(--text-primary);
    }

    .poem-info p {
      margin: 5px 0;
      color: var(--text-secondary);
    }

    .loading {
      text-align: center;
      padding: 50px;
      font-size: 1.2rem;
      color: #666;
    }

    .error {
      color: #e74c3c;
      text-align: center;
      padding: 20px;
      background: #ffeaea;
      border-radius: 10px;
      margin: 20px 0;
    }

    @media (max-width: 768px) {
      body {
        padding: 10px;
      }
      
      .container {
        padding: 20px;
        margin: 10px;
      }
      
      .copy-btn {
        position: relative;
        top: auto;
        right: auto;
        display: block;
        margin: 20px auto;
        width: 100%;
        max-width: 200px;
      }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>诗词解读</h1>
      <div class="subtitle">AI 智能解析，深度阐释诗情画意</div>
    </header>
    
    <div id="interpretation-content" class="interpretation-content">
      <div class="loading">正在生成解读，请稍候...</div>
    </div>
  </div>
  
  <button id="copy-btn" class="copy-btn">复制全文</button>

  <script>
    // Get the content from URL parameter
    const urlParams = new URLSearchParams(window.location.search);
    const markdownContent = urlParams.get('content');
    const poemInfo = urlParams.get('info');
    
    // Function to convert markdown to HTML (simple implementation)
    function markdownToHtml(md) {
      if (!md) return '<div class="error">未能获取到解读内容</div>';
      
      // Simple markdown conversion
      let html = md
        // Headers
        .replace(/^### (.*$)/gim, '<h3>$1</h3>')
        .replace(/^## (.*$)/gim, '<h2>$1</h2>')
        .replace(/^# (.*$)/gim, '<h1>$1</h1>')
        // Bold
        .replace(/\*\*(.*)\*\*/gim, '<strong>$1</strong>')
        // Italic
        .replace(/\*(.*)\*/gim, '<em>$1</em>')
        // Links
        .replace(/\[(.*?)\]\((.*?)\)/gim, '<a href="$2">$1</a>')
        // Code blocks
        .replace(/```([\s\S]*?)```/gim, '<pre><code>$1</code></pre>')
        // Inline code
        .replace(/`(.*?)`/gim, '<code>$1</code>')
        // Blockquotes
        .replace(/^> (.*$)/gim, '<blockquote>$1</blockquote>')
        // Unordered lists
        .replace(/^\- (.*$)/gim, '<li>$1</li>')
        // Ordered lists
        .replace(/^\d+\. (.*$)/gim, '<li>$1</li>')
        // Paragraphs
        .replace(/\n\n/gim, '</p><p>')
        .replace(/\n/gim, '<br>');
      
      // Clean up
      html = html.replace('<p></p>', '');
      html = `<p>${html}</p>`;
      
      // Handle lists
      html = html.replace(/<p><li>/gim, '<ul><li>')
                 .replace(/<\/li><\/p>/gim, '</li></ul>')
                 .replace(/<\/li><li>/gim, '</li><li>');
      
      return html;
    }
    
    // Display content
    document.addEventListener('DOMContentLoaded', () => {
      const contentDiv = document.getElementById('interpretation-content');
      
      if (poemInfo) {
        try {
          const infoObj = JSON.parse(decodeURIComponent(poemInfo));
          const infoHtml = `
            <div class="poem-info">
              <h2>诗词信息</h2>
              <p><strong>标题：</strong>${infoObj.title || '未知'}</p>
              <p><strong>作者：</strong>${infoObj.author || '未知'}</p>
              <p><strong>朝代：</strong>${infoObj.dynasty || '未知'}</p>
              <p><strong>类型：</strong>${infoObj.type || '未知'}</p>
            </div>
          `;
          contentDiv.innerHTML = infoHtml;
        } catch (e) {
          console.error('Error parsing poem info:', e);
        }
      }
      
      if (markdownContent) {
        contentDiv.innerHTML += markdownToHtml(decodeURIComponent(markdownContent));
      } else {
        contentDiv.innerHTML = '<div class="error">未能获取到解读内容，请返回重试</div>';
      }
      
      // Add copy functionality
      const copyBtn = document.getElementById('copy-btn');
      copyBtn.addEventListener('click', () => {
        const contentToCopy = document.getElementById('interpretation-content').innerText;
        
        navigator.clipboard.writeText(contentToCopy)
          .then(() => {
            // Show temporary success message
            const originalText = copyBtn.innerText;
            copyBtn.innerText = '已复制！';
            
            setTimeout(() => {
              copyBtn.innerText = originalText;
            }, 2000);
          })
          .catch(err => {
            console.error('复制失败:', err);
            alert('复制失败，请手动选择文本进行复制');
          });
      });
    });
  </script>
</body>
</html>