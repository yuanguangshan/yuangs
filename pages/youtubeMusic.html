<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>YouTube Music</title>
    <style>
        :root {
            --yt-bg: #0a0a0a;
            --yt-surface: #121212;
            --yt-card: #1a1a1a;
            --yt-card-hover: #252525;
            --yt-border: #2a2a2a;
            --yt-text: #ffffff;
            --yt-text-sub: #a0a0a0;
            --yt-accent: #ff0033;
            --yt-accent-hover: #ff3355;
            --yt-accent-glow: rgba(255, 0, 51, 0.3);
            --gradient-1: linear-gradient(135deg, #ff0033 0%, #ff6b35 100%);
            --gradient-2: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-3: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --card-radius: 20px;
            --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            padding: 0;
            background: var(--yt-bg);
            color: var(--yt-text);
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "PingFang SC", "Microsoft YaHei", sans-serif;
            min-height: 100vh;
        }

        /* Animated Background */
        .bg-gradient {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(ellipse at 20% 20%, rgba(255, 0, 51, 0.08) 0%, transparent 50%),
                radial-gradient(ellipse at 80% 80%, rgba(102, 126, 234, 0.08) 0%, transparent 50%),
                radial-gradient(ellipse at 50% 50%, rgba(240, 147, 251, 0.05) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        header {
            position: sticky;
            top: 0;
            z-index: 100;
            background: rgba(10, 10, 10, 0.85);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
            padding: 16px clamp(20px, 5vw, 60px);
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 16px;
            flex-shrink: 0;
        }

        .logo-icon {
            width: 48px;
            height: 48px;
            background: var(--gradient-1);
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 15px var(--yt-accent-glow);
        }

        .logo-icon svg {
            width: 28px;
            height: 28px;
            fill: white;
        }

        .logo h1 {
            margin: 0;
            font-size: 1.6rem;
            font-weight: 700;
            background: var(--gradient-1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .search-wrapper {
            flex: 1;
            max-width: 600px;
            margin: 0 auto;
        }

        .search-form {
            display: flex;
            align-items: center;
            background: var(--yt-surface);
            border: 1px solid var(--yt-border);
            border-radius: 50px;
            padding: 4px 4px 4px 20px;
            transition: var(--transition);
        }

        .search-form:focus-within {
            border-color: var(--yt-accent);
            box-shadow: 0 0 0 3px var(--yt-accent-glow);
        }

        .search-form input {
            flex: 1;
            background: transparent;
            border: none;
            color: var(--yt-text);
            font-size: 1rem;
            padding: 12px 0;
            outline: none;
        }

        .search-form input::placeholder {
            color: var(--yt-text-sub);
        }

        .search-btn {
            width: 44px;
            height: 44px;
            border-radius: 50%;
            background: var(--gradient-1);
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: var(--transition);
            flex-shrink: 0;
        }

        .search-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 20px var(--yt-accent-glow);
        }

        .search-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .search-btn svg {
            width: 20px;
            height: 20px;
            fill: white;
        }

        main {
            position: relative;
            z-index: 1;
            padding: 32px clamp(20px, 5vw, 60px) 80px;
            max-width: 1400px;
            margin: 0 auto;
        }

        .status-bar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 24px;
            flex-wrap: wrap;
            gap: 16px;
        }

        .status {
            font-size: 0.95rem;
            color: var(--yt-text-sub);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .status.loading {
            color: #fbbf24;
        }

        .status.loading::before {
            content: '';
            width: 16px;
            height: 16px;
            border: 2px solid #fbbf24;
            border-top-color: transparent;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        .status.success {
            color: #34d399;
        }

        .status.error {
            color: #f87171;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .shuffle-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 20px;
            background: var(--yt-card);
            border: 1px solid var(--yt-border);
            border-radius: 50px;
            color: var(--yt-text);
            font-size: 0.9rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .shuffle-btn:hover {
            background: var(--yt-card-hover);
            border-color: var(--yt-accent);
        }

        .shuffle-btn svg {
            width: 18px;
            height: 18px;
        }

        .results {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 24px;
        }

        .song-card {
            background: var(--yt-card);
            border-radius: var(--card-radius);
            border: 1px solid var(--yt-border);
            overflow: hidden;
            transition: var(--transition);
            cursor: pointer;
        }

        .song-card:hover {
            transform: translateY(-4px);
            border-color: rgba(255, 255, 255, 0.1);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
        }

        .song-card.playing {
            border-color: var(--yt-accent);
            box-shadow: 0 0 30px var(--yt-accent-glow);
        }

        .thumb-wrapper {
            position: relative;
            width: 100%;
            aspect-ratio: 16 / 9;
            background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
            overflow: hidden;
        }

        .thumb-wrapper img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: var(--transition);
        }

        .song-card:hover .thumb-wrapper img {
            transform: scale(1.05);
        }

        .play-overlay {
            position: absolute;
            inset: 0;
            background: rgba(0, 0, 0, 0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: var(--transition);
        }

        .song-card:hover .play-overlay {
            opacity: 1;
        }

        .play-btn {
            width: 64px;
            height: 64px;
            background: var(--yt-accent);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 8px 30px var(--yt-accent-glow);
            transform: scale(0.8);
            transition: var(--transition);
        }

        .song-card:hover .play-btn {
            transform: scale(1);
        }

        .play-btn svg {
            width: 28px;
            height: 28px;
            fill: white;
            margin-left: 4px;
        }

        .video-container {
            position: relative;
            width: 100%;
            aspect-ratio: 16 / 9;
        }

        .video-container iframe {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border: 0;
        }

        .song-info {
            padding: 20px;
        }

        .song-info h3 {
            margin: 0 0 12px;
            font-size: 1.1rem;
            font-weight: 600;
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            cursor: pointer;
            transition: var(--transition);
        }

        .song-info h3:hover {
            color: var(--yt-accent);
        }

        .meta-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .meta {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            color: var(--yt-text-sub);
            cursor: pointer;
            transition: var(--transition);
        }

        .meta:hover {
            color: var(--yt-text);
        }

        .meta-icon {
            width: 18px;
            height: 18px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        /* Tag Suggestions */
        .tag-suggestions {
            text-align: center;
            padding: 60px 20px;
        }

        .tag-suggestions h2 {
            font-size: 1.5rem;
            margin-bottom: 12px;
            background: var(--gradient-2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .tag-suggestions p {
            color: var(--yt-text-sub);
            margin-bottom: 32px;
        }

        .tag-grid {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 12px;
            max-width: 600px;
            margin: 0 auto;
        }

        .tag-chip {
            padding: 12px 24px;
            background: var(--yt-card);
            border: 1px solid var(--yt-border);
            border-radius: 50px;
            color: var(--yt-text);
            font-size: 0.95rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .tag-chip:hover {
            background: var(--yt-card-hover);
            border-color: var(--yt-accent);
            transform: translateY(-2px);
        }

        .tag-chip:nth-child(1) { background: linear-gradient(135deg, rgba(255, 0, 51, 0.2) 0%, rgba(255, 107, 53, 0.2) 100%); border-color: rgba(255, 0, 51, 0.3); }
        .tag-chip:nth-child(2) { background: linear-gradient(135deg, rgba(102, 126, 234, 0.2) 0%, rgba(118, 75, 162, 0.2) 100%); border-color: rgba(102, 126, 234, 0.3); }
        .tag-chip:nth-child(3) { background: linear-gradient(135deg, rgba(240, 147, 251, 0.2) 0%, rgba(245, 87, 108, 0.2) 100%); border-color: rgba(240, 147, 251, 0.3); }
        .tag-chip:nth-child(4) { background: linear-gradient(135deg, rgba(52, 211, 153, 0.2) 0%, rgba(16, 185, 129, 0.2) 100%); border-color: rgba(52, 211, 153, 0.3); }

        /* Pagination */
        .pagination-container {
            display: flex;
            justify-content: center;
            margin-top: 20px;
        }

        .pagination {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px 20px;
            background: var(--yt-card);
            border: 1px solid var(--yt-border);
            border-radius: 50px;
        }

        .page-btn {
            padding: 8px 16px;
            background: transparent;
            border: 1px solid var(--yt-border);
            border-radius: 8px;
            color: var(--yt-text);
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.9rem;
        }

        .page-btn:hover:not(:disabled) {
            background: var(--yt-card-hover);
            border-color: var(--yt-accent);
        }

        .page-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .page-info {
            min-width: 120px;
            text-align: center;
            color: var(--yt-text);
            font-size: 0.95rem;
        }

        .page-numbers {
            display: flex;
            align-items: center;
            gap: 6px;
            padding: 0 12px;
        }

        .page-number {
            padding: 8px 12px;
            background: transparent;
            border: 1px solid var(--yt-border);
            border-radius: 8px;
            color: var(--yt-text);
            cursor: pointer;
            transition: var(--transition);
            font-size: 0.9rem;
            min-width: 40px;
        }

        .page-number:hover:not(:disabled) {
            background: var(--yt-card-hover);
            border-color: var(--yt-accent);
        }

        .page-number.active {
            background: var(--yt-accent);
            border-color: var(--yt-accent);
        }

        /* Skeleton Loading */
        .skeleton {
            background: var(--yt-card);
            border-radius: var(--card-radius);
            border: 1px solid var(--yt-border);
            overflow: hidden;
        }

        .skeleton-thumb {
            width: 100%;
            aspect-ratio: 16 / 9;
            background: linear-gradient(90deg, #1a1a1a 25%, #252525 50%, #1a1a1a 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }

        .skeleton-info {
            padding: 20px;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .skeleton-line {
            height: 16px;
            border-radius: 8px;
            background: linear-gradient(90deg, #1a1a1a 25%, #252525 50%, #1a1a1a 75%);
            background-size: 200% 100%;
            animation: shimmer 1.5s infinite;
        }

        .skeleton-line:nth-child(1) { width: 80%; height: 20px; }
        .skeleton-line:nth-child(2) { width: 60%; }
        .skeleton-line:nth-child(3) { width: 50%; }

        @keyframes shimmer {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* Welcome Screen */
        .welcome-screen {
            text-align: center;
            padding: 80px 20px;
        }

        .welcome-icon {
            width: 120px;
            height: 120px;
            background: var(--gradient-1);
            border-radius: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 32px;
            box-shadow: 0 20px 60px var(--yt-accent-glow);
        }

        .welcome-icon svg {
            width: 60px;
            height: 60px;
            fill: white;
        }

        .welcome-screen h2 {
            font-size: 2rem;
            margin-bottom: 16px;
            background: linear-gradient(135deg, #fff 0%, #a0a0a0 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .welcome-screen p {
            color: var(--yt-text-sub);
            font-size: 1.1rem;
            max-width: 500px;
            margin: 0 auto 40px;
            line-height: 1.6;
        }

        .quick-tags {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 12px;
            max-width: 800px;
            margin: 0 auto;
        }

        .quick-tag {
            padding: 10px 20px;
            background: var(--yt-card);
            border: 1px solid var(--yt-border);
            border-radius: 50px;
            color: var(--yt-text);
            font-size: 0.9rem;
            cursor: pointer;
            transition: var(--transition);
        }

        .quick-tag:hover {
            background: var(--yt-card-hover);
            border-color: var(--yt-accent);
        }

        /* Responsive */
        @media (max-width: 768px) {
            header {
                flex-direction: column;
                gap: 16px;
                padding: 16px 20px;
            }

            .logo {
                width: 100%;
                justify-content: center;
            }

            .logo-icon {
                width: 40px;
                height: 40px;
            }

            .logo-icon svg {
                width: 24px;
                height: 24px;
            }

            .logo h1 {
                font-size: 1.4rem;
            }

            .search-wrapper {
                width: 100%;
                max-width: none;
            }

            .results {
                grid-template-columns: 1fr;
            }

            .welcome-screen {
                padding: 40px 20px;
            }

            .welcome-screen h2 {
                font-size: 1.5rem;
            }

            .welcome-icon {
                width: 80px;
                height: 80px;
                border-radius: 20px;
            }

            .welcome-icon svg {
                width: 40px;
                height: 40px;
            }
        }

        @media (max-width: 480px) {
            .status-bar {
                flex-direction: column;
                align-items: flex-start;
            }

            .shuffle-btn {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>

<body>
    <div class="bg-gradient"></div>

    <header>
        <div class="logo">
            <div class="logo-icon">
                <svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
            </div>
            <h1>YouTube Music</h1>
        </div>
        <div class="search-wrapper">
            <form id="searchForm" class="search-form">
                <input type="text" id="query" name="query" placeholder="ÊêúÁ¥¢Èü≥‰πê„ÄÅÊ≠åÊâã„ÄÅ‰∏ìËæë..." required>
                <button type="submit" id="searchBtn" class="search-btn" aria-label="ÊêúÁ¥¢">
                    <svg viewBox="0 0 24 24"><path d="M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
                </button>
            </form>
        </div>
    </header>

    <main>
        <div class="status-bar">
            <div class="status" id="statusText"></div>
            <button class="shuffle-btn" id="shuffleBtn">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="16 3 21 3 21 8"></polyline>
                    <line x1="4" y1="20" x2="21" y2="3"></line>
                    <polyline points="21 16 21 21 16 21"></polyline>
                    <line x1="15" y1="15" x2="21" y2="21"></line>
                    <line x1="4" y1="4" x2="9" y2="9"></line>
                </svg>
                ÈöèÊú∫ÂèëÁé∞
            </button>
        </div>
        <section class="results" id="results">
            <div class="welcome-screen" id="welcomeScreen">
                <div class="welcome-icon">
                    <svg viewBox="0 0 24 24"><path d="M12 3v10.55c-.59-.34-1.27-.55-2-.55-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4V7h4V3h-6z"/></svg>
                </div>
                <h2>ÂèëÁé∞‰Ω†ÁöÑ‰∏ã‰∏ÄÈ¶ñÊúÄÁà±</h2>
                <p>ÊêúÁ¥¢Ê≠åÊõ≤„ÄÅÊ≠åÊâãÊàñ‰∏ìËæëÔºåÊàñËÄÖËØïËØï‰∏ãÈù¢ÁöÑÁÉ≠Èó®Ê†áÁ≠æ</p>
                <div class="quick-tags" id="quickTags"></div>
            </div>
        </section>
        <div id="pagination-container" class="pagination-container" style="display: none; text-align: center; margin-top: 20px;">
            <div class="pagination">
                <div id="page-numbers" class="page-numbers"></div>
            </div>
        </div>
    </main>

    <script>
        const API_BASE_URL = 'https://api.yuangs.cc';

        // Èü≥‰πêÊ†áÁ≠æÁ≥ªÁªü
        const musicTags = {
            attributes: {
                moods: {
                    positive: ["Happy", "Joy", "Cheerful", "Uplifting", "Energetic", "Upbeat", "Euphoria", "Peaceful", "Calm", "Serene", "Chill", "Relax", "Cozy", "Mellow", "Groovy", "Cool", "Fresh"],
                    romantic: ["Love", "Romantic", "Heart", "Kiss", "Miss", "Baby", "Intimate", "Affection", "Passion", "Sensual", "Sexy"],
                    melancholy: ["Sad", "Melancholy", "Nostalgia", "Sentimental", "Blue", "Tears", "Lonely", "Gloomy", "Melancholic", "Heartbreak"],
                    intense: ["Drama", "Intense", "Power", "Epic", "Cinematic", "Dark", "Mystery", "Mysterious", "Heavy", "Spooky", "Creepy", "Supernatural"],
                    spiritual: ["Faith", "Believe", "Angels", "Heaven", "Paradise", "Divine", "Sacred", "Spiritual", "Transcendent", "Soulful"]
                },
                styles: {
                    sonic: ["Acoustic", "Electric", "Instrumental", "Acapella", "Live", "Studio", "Remix", "Cover", "Original"],
                    aesthetic: ["Vintage", "Retro", "Classic", "Modern", "Futuristic", "Cyberpunk", "Aesthetic", "Pastel", "Neon", "Funky"]
                }
            },
            genres: {
                main: {
                    pop: ["Pop", "Mandopop", "Cantopop", "K-Pop", "J-Pop", "Jazz", "Soul", "R&B"],
                    rock: ["Rock", "Alternative", "Indie", "Punk", "Grunge", "Emo", "Metal", "Heavy Metal"],
                    electronic: ["EDM", "House", "Techno", "Trance", "Dubstep", "Drum and Bass", "Garage", "Ambient"],
                    hip_hop: ["Hip Hop", "Rap", "Trap", "R&B"],
                    traditional: ["Country", "Folk", "Classical", "Opera", "Blues"],
                    world: ["Latin", "Reggae", "Dancehall", "Salsa", "Bachata", "Reggaeton", "Anime", "Ghibli"]
                },
                sub_genres: {
                    pop_sub: ["Synthpop", "Electropop", "Dance-pop", "Indie Pop", "Art Pop"],
                    rock_sub: ["Glam Rock", "Progressive Rock", "Punk Rock", "Hard Rock", "Grunge Rock", "Alternative Rock"],
                    electronic_sub: ["Lo-Fi", "Lofi Hip Hop", "Synthwave", "Vaporwave", "Retrowave", "Deep House", "Future Bass"],
                    hip_hop_sub: ["Old School Hip Hop", "Trap", "Drill", "Conscious Rap", "Mumble Rap"],
                    traditional_sub: ["Bluegrass", "Folk Rock", "Baroque", "Chamber Music", "Contemporary Classical"]
                }
            },
            scenarios: {
                time_based: {
                    daily_routine: ["Morning", "Wake Up", "Afternoon", "Evening", "Late Night", "Midnight", "Sunrise", "Sunset"],
                    weekly: ["Weekend", "Friday", "Sunday", "Monday", "Workday"],
                    seasonal: ["Spring", "Summer", "Autumn", "Winter", "Holiday", "New Year", "Valentine", "Christmas", "Halloween"],
                    special_occasions: ["Birthday", "Wedding", "Graduation", "Travel", "Vacation", "Beach", "Camping", "Festival"]
                },
                activity_based: {
                    exercise: ["Workout", "Gym", "Running", "Jogging", "Yoga", "Meditation", "Stretching"],
                    work_study: ["Study", "Coding", "Reading", "Focus", "Background", "Concentration", "Deep Work"],
                    travel: ["Driving", "Road Trip", "Car Music", "Commuting", "Long Drive"],
                    social: ["Party", "Club", "Bar", "Lounge", "Dinner", "Cooking", "Cleaning"],
                    relaxation: ["Sleep", "Meditation", "Spa", "Shower", "Bath", "Coffee Shop", "Cafe"]
                }
            },
            culture: {
                regional: {
                    western: ["American", "British", "European", "African", "Caribbean"],
                    asian: ["Chinese", "Korean", "Japanese", "Taiwanese", "Hong Kong", "Southeast Asian"],
                    latin: ["Latin America", "Brazil", "Mexico", "Caribbean"]
                },
                artists: {
                    western_mainstream: ["Taylor Swift", "Ed Sheeran", "Ariana Grande", "Justin Bieber", "The Weeknd", "Dua Lipa", "Billie Eilish", "Harry Styles", "Bruno Mars", "Adele", "Rihanna", "Beyonce", "Lady Gaga", "Katy Perry", "Miley Cyrus", "Post Malone", "Coldplay", "Imagine Dragons", "OneRepublic", "Drake", "Kendrick Lamar", "Eminem", "Jay-Z", "Travis Scott", "Kanye West", "J. Cole", "Beatles", "Queen", "Pink Floyd", "Led Zeppelin", "AC/DC", "Red Hot Chili Peppers", "Linkin Park", "Arctic Monkeys", "Tame Impala", "Oasis", "David Bowie", "Prince", "Elton John", "Bob Dylan", "Beyonc√©", "Alicia Keys", "John Legend"],
                    korean: ["BTS", "Blackpink", "Twice", "EXO", "Big Bang", "NewJeans", "Stray Kids", "IU", "SEVENTEEN"],
                    chinese: ["Âë®Êù∞‰º¶", "Êûó‰øäÊù∞", "ÈôàÂ•ïËøÖ", "ÁéãÂäõÂÆè", "Èô∂ÂñÜ", "Ëî°‰æùÊûó", "Â≠ôÁáïÂßø", "Ê¢ÅÈùôËåπ", "‰∫îÊúàÂ§©", "Beyond", "ÈÇì‰∏ΩÂêõ", "Âº†ÂõΩËç£", "ÁéãËè≤", "Âº†Â≠¶Âèã", "ÂàòÂæ∑Âçé", "ÈªéÊòé", "ÈÉ≠ÂØåÂüé", "ÁΩóÂ§ß‰Ωë", "ÊùéÂÆóÁõõ", "Â¥îÂÅ•", "Á™¶ÂîØ", "‰ºç‰Ω∞", "Âº†Èõ®Áîü", "ÈÇìÁ¥´Ê£ã", "ÊùéËç£Êµ©", "Ëñõ‰πãË∞¶", "Âë®Ê∑±", "ÊØõ‰∏çÊòì", "ÂçéÊô®ÂÆá", "Âº†Êù∞", "ËÆ∏Âµ©", "Âëä‰∫î‰∫∫", "Áóõ‰ª∞", "ÈôàÁ≤í", "ËµµÈõ∑"],
                    japanese: ["ÂÆâÂÆ§Â•àÁæéÊÅµ", "ÂÆáÂ§öÁî∞„Éí„Ç´„É´", "Á±≥Ê¥•ÁéÑÂ∏´", "RADWIMPS", "YOASOBI"],
                    instrumental: ["Hans Zimmer", "John Williams", "Joe Hisaishi", "Ennio Morricone", "Ludwig G√∂ransson"]
                },
                media: {
                    franchises: ["Marvel", "DC", "Star Wars", "Harry Potter", "Lord of the Rings", "Game of the Thrones"],
                    shows: ["Stranger Things", "Friends", "Simpsons", "Breaking Bad", "The Office"],
                    games: ["Cyberpunk 2077", "GTA", "FIFA", "Mario", "Zelda", "Pokemon", "Fortnite"],
                    other: ["Disney", "Musical", "Broadway", "Anime OST", "Video Game Music"]
                }
            },
            nature_abstract: {
                nature: {
                    weather: ["Rain", "Storm", "Thunder", "Snow", "Wind", "Sun", "Moon", "Stars"],
                    landscapes: ["Ocean", "Sea", "River", "Forest", "Jungle", "Mountain", "Desert"],
                    locations: ["California", "New York", "London", "Paris", "Tokyo", "Seoul", "Hong Kong", "Shanghai", "Miami", "Ibiza", "Hawaii", "Space", "Galaxy", "Universe", "City", "Street", "Highway"]
                },
                abstract: {
                    transcendental: ["Dream", "Night", "Fire", "Gold", "Wild", "Free", "Magic", "Legend", "Hero", "Angel", "Devil", "King", "Queen", "Life", "Time", "Eternity"],
                    emotions: ["Hope", "Smile", "Believe", "Together", "Alone", "Lost", "Forever", "Secret", "Promise"]
                }
            }
        };

        // Ëé∑ÂèñÊâÄÊúâÊ†áÁ≠æ
        function getAllTags() {
            const tags = [];
            function extractTags(obj) {
                if (Array.isArray(obj)) {
                    tags.push(...obj);
                } else if (typeof obj === 'object') {
                    Object.values(obj).forEach(extractTags);
                }
            }
            extractTags(musicTags);
            return tags;
        }

        const allTags = getAllTags();

        // Ëé∑ÂèñÈöèÊú∫Ê†áÁ≠æ
        function getRandomTags(count = 4) {
            const shuffled = [...allTags].sort(() => Math.random() - 0.5);
            return shuffled.slice(0, count);
        }

        // Ëé∑ÂèñÂçï‰∏™ÈöèÊú∫Ê†áÁ≠æ
        function getRandomTag() {
            return allTags[Math.floor(Math.random() * allTags.length)];
        }

        const searchForm = document.getElementById('searchForm');
        const searchBtn = document.getElementById('searchBtn');
        const resultsContainer = document.getElementById('results');
        const statusText = document.getElementById('statusText');
        const shuffleBtn = document.getElementById('shuffleBtn');
        const quickTags = document.getElementById('quickTags');

        // Pagination variables
        let currentPage = 1;
        const itemsPerPage = 10;
        let allSongs = []; // Store all fetched songs

        // URLÂèÇÊï∞Ëé∑Âèñ
        function getUrlParameter(name) {
            const urlParams = new URLSearchParams(window.location.search);
            return urlParams.get(name);
        }

        const urlLimit = getUrlParameter('n');
        let defaultLimit = 50;
        if (urlLimit && !isNaN(urlLimit)) {
            const numericLimit = parseInt(urlLimit);
            if (numericLimit >= 1 && numericLimit <= 50) {
                defaultLimit = numericLimit;
            }
        }

        // ÂàùÂßãÂåñÂø´ÈÄüÊ†áÁ≠æ
        function initQuickTags() {
            const tags = getRandomTags(8);
            quickTags.innerHTML = tags.map(tag => 
                `<button class="quick-tag" onclick="searchTag('${tag}')">${tag}</button>`
            ).join('');
        }

        // ÊòæÁ§∫Ê†áÁ≠æÂª∫ËÆÆ
        function showTagSuggestions() {
            const tags = getRandomTags(4);
            resultsContainer.innerHTML = `
                <div class="tag-suggestions" style="grid-column: 1 / -1;">
                    <h2>Ê≤°ÊúâÊâæÂà∞ÁªìÊûú</h2>
                    <p>ËØïËØïËøô‰∫õÁÉ≠Èó®Ê†áÁ≠æ</p>
                    <div class="tag-grid">
                        ${tags.map(tag => `<button class="tag-chip" onclick="searchTag('${tag}')">${tag}</button>`).join('')}
                    </div>
                </div>
            `;
            // Hide pagination when showing suggestions
            document.getElementById('pagination-container').style.display = 'none';
        }

        // ÊêúÁ¥¢Ê†áÁ≠æ
        function searchTag(tag) {
            document.getElementById('query').value = tag;
            currentPage = 1; // Reset to first page on new search
            searchForm.dispatchEvent(new Event('submit', { cancelable: true, bubbles: true }));
        }

        // ÈöèÊú∫ÊêúÁ¥¢
        shuffleBtn.addEventListener('click', () => {
            const randomTag = getRandomTag();
            document.getElementById('query').value = randomTag;
            currentPage = 1; // Reset to first page on new search
            searchForm.dispatchEvent(new Event('submit', { cancelable: true, bubbles: true }));
        });

        // ÊêúÁ¥¢Ë°®ÂçïÊèê‰∫§
        searchForm.addEventListener('submit', async (event) => {
            event.preventDefault();
            const query = document.getElementById('query').value.trim();
            const limit = defaultLimit;

            if (!query) {
                statusText.textContent = 'ËØ∑ËæìÂÖ•ÊêúÁ¥¢ÂÖ≥ÈîÆËØç';
                statusText.className = 'status error';
                return;
            }

            statusText.textContent = 'ÊêúÁ¥¢‰∏≠...';
            statusText.className = 'status loading';
            searchBtn.disabled = true;

            // ÊòæÁ§∫È™®Êû∂Â±è
            resultsContainer.innerHTML = Array.from({ length: 6 }, () => `
                <article class="skeleton">
                    <div class="skeleton-thumb"></div>
                    <div class="skeleton-info">
                        <div class="skeleton-line"></div>
                        <div class="skeleton-line"></div>
                        <div class="skeleton-line"></div>
                    </div>
                </article>
            `).join('');

            try {
                const url = new URL('/youtubeapi/search/song', API_BASE_URL);
                url.searchParams.set('q', query);
                url.searchParams.set('limit', limit);

                const response = await fetch(url.toString());
                const result = await response.json();

                if (!response.ok || !result.success) {
                    throw new Error(result.error || 'ËØ∑Ê±ÇÂ§±Ë¥•');
                }

                if (result.data.length === 0) {
                    showTagSuggestions();
                    document.getElementById('pagination-container').style.display = 'none';
                    statusText.textContent = 'Ê≤°ÊúâÊâæÂà∞ÂåπÈÖçÁöÑÊ≠åÊõ≤';
                    statusText.className = 'status';
                } else {
                    renderResults(result.data);
                    statusText.textContent = `ÊâæÂà∞ ${result.data.length} È¶ñÊ≠åÊõ≤`;
                    statusText.className = 'status success';
                }
            } catch (error) {
                statusText.textContent = `ËØ∑Ê±ÇÂá∫ÈîôÔºö${error.message}`;
                statusText.className = 'status error';
                document.getElementById('pagination-container').style.display = 'none';
                showTagSuggestions();
            } finally {
                searchBtn.disabled = false;
            }
        });

        function renderResults(songs = []) {
            // Store all songs for pagination
            allSongs = songs;
            currentPage = 1;

            // Show first page of results
            displayPage(currentPage);
        }

        function displayPage(page) {
            const startIndex = (page - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            const pageSongs = allSongs.slice(startIndex, endIndex);

            resultsContainer.innerHTML = pageSongs.map(song => {
                const artists = (song.artists || []).join('„ÄÅ') || 'Êú™Áü•Ëâ∫ÊúØÂÆ∂';
                const album = song.album || 'Êú™Áü•‰∏ìËæë';
                const duration = song.duration || '--:--';
                const thumbnail = song.thumbnail_url || '';

                let videoId = '';
                if (song.youtube_url) {
                    try {
                        const urlObj = new URL(song.youtube_url);
                        videoId = urlObj.searchParams.get('v');
                    } catch (e) {
                        console.error('Invalid YouTube URL:', song.youtube_url);
                    }
                }

                return `
                    <article class="song-card" data-video-id="${videoId}">
                        <div class="thumb-wrapper">
                            ${thumbnail ?
                                `<img src="${thumbnail}" alt="${song.title}" onerror="this.style.display='none'">` :
                                ''
                            }
                            <div class="play-overlay">
                                <div class="play-btn">
                                    <svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
                                </div>
                            </div>
                        </div>
                        <div class="song-info">
                            <h3 onclick="searchTag('${(song.title || '').replace(/'/g, "\\'")}'); event.stopPropagation();">${song.title || 'Êú™ÂëΩÂêçÊ≠åÊõ≤'}</h3>
                            <div class="meta-list">
                                <div class="meta" onclick="searchTag('${artists.replace(/'/g, "\\'")}'); event.stopPropagation();">
                                    <span class="meta-icon">üé§</span>
                                    <span>${artists}</span>
                                </div>
                                <div class="meta" onclick="searchTag('${album.replace(/'/g, "\\'")}'); event.stopPropagation();">
                                    <span class="meta-icon">üíø</span>
                                    <span>${album}</span>
                                </div>
                                <div class="meta">
                                    <span class="meta-icon">‚è±Ô∏è</span>
                                    <span>${duration}</span>
                                </div>
                            </div>
                        </div>
                    </article>
                `;
            }).join('');

            // Ê∑ªÂä†ÁÇπÂáªÊí≠Êîæ‰∫ã‰ª∂
            document.querySelectorAll('.song-card').forEach(card => {
                card.addEventListener('click', function(e) {
                    if (e.target.closest('h3') || e.target.closest('.meta')) return;
                    playVideo(this);
                });
            });

            // Update pagination controls
            updatePaginationControls();
        }

        function updatePaginationControls() {
            const totalPages = Math.ceil(allSongs.length / itemsPerPage);
            const paginationContainer = document.getElementById('pagination-container');
            const pageNumbersContainer = document.getElementById('page-numbers');

            // Clear existing page numbers
            pageNumbersContainer.innerHTML = '';

            // Show pagination only if we have more than 1 page
            if (totalPages <= 1) {
                paginationContainer.style.display = 'none';
                return;
            }

            // Determine which pages to show (5-6 pages centered on current page)
            let startPage = Math.max(1, currentPage - 2);
            let endPage = Math.min(totalPages, startPage + 4);

            // Adjust start page if we're near the end
            if (endPage - startPage < 4) {
                startPage = Math.max(1, endPage - 4);
            }

            // Generate page number buttons (only 5-6 pages)
            for (let i = startPage; i <= endPage; i++) {
                const pageButton = document.createElement('button');
                pageButton.className = `page-number ${i === currentPage ? 'active' : ''}`;
                pageButton.textContent = i;
                pageButton.onclick = () => {
                    currentPage = i;
                    displayPage(currentPage);
                };
                pageNumbersContainer.appendChild(pageButton);
            }

            // Show/hide pagination based on whether we have results
            paginationContainer.style.display = 'flex';
        }

        function playVideo(cardElement) {
            const videoId = cardElement.dataset.videoId;
            if (!videoId || cardElement.classList.contains('playing')) return;

            // ÂÅúÊ≠¢ÂÖ∂‰ªñÊ≠£Âú®Êí≠ÊîæÁöÑËßÜÈ¢ë
            document.querySelectorAll('.song-card.playing').forEach(card => {
                if (card !== cardElement) {
                    card.classList.remove('playing');
                    const wrapper = card.querySelector('.thumb-wrapper');
                    const originalImg = card.dataset.originalThumb;
                    wrapper.innerHTML = `
                        ${originalImg ? `<img src="${originalImg}" alt="">` : ''}
                        <div class="play-overlay">
                            <div class="play-btn">
                                <svg viewBox="0 0 24 24"><path d="M8 5v14l11-7z"/></svg>
                            </div>
                        </div>
                    `;
                }
            });

            const thumbWrapper = cardElement.querySelector('.thumb-wrapper');
            const img = thumbWrapper.querySelector('img');
            if (img) {
                cardElement.dataset.originalThumb = img.src;
            }

            cardElement.classList.add('playing');
            thumbWrapper.innerHTML = `
                <div class="video-container">
                    <iframe 
                        src="https://www.youtube.com/embed/${videoId}?autoplay=1" 
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" 
                        allowfullscreen>
                    </iframe>
                </div>
            `;
        }

        // ÂàùÂßãÂåñ
        initQuickTags();


        // È°µÈù¢Âä†ËΩΩÊó∂ÈöèÊú∫ÊêúÁ¥¢
        window.addEventListener('load', () => {
            const randomTag = getRandomTag();
            document.getElementById('query').value = randomTag;
            searchForm.dispatchEvent(new Event('submit', { cancelable: true, bubbles: true }));
        });
    </script>
</body>

</html>